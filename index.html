<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Markdown2PDF Pro</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.11/dist/purify.min.js"></script>
<style>
:root {
--bg-primary: #1a1f2b;
--bg-secondary: #222837;
--bg-panel: #252b3a;
--bg-toolbar: #2d3445;
--border-color: #3a4154;
--text-primary: #e6e9f0;
--text-secondary: #a0a8bc;
--accent-color: #4d9de0;
--accent-hover: #3a85c9;
--preview-bg: #ffffff;
--preview-text: #1a1f2b;
--modal-bg: #1e2433;
--modal-border: #353d4e;
--code-bg: #f8f9fa;
--code-border: #e9ecef;
--success-color: #10b981;
--error-color: #ef4444;
--warning-color: #f59e0b;
--quote-color: #a0a8bc;
--search-bg: #2a3141;
--search-border: #4a5265;
--search-highlight: rgba(77, 157, 224, 0.3);
--current-line-bg: rgba(77, 157, 224, 0.15);
--theme-icon: #ffc107;
--notification-shadow: 0 4px 12px rgba(0,0,0,0.25);
--panel-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
--modal-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
--dot-bg: #e3f2fd;
--dot-border: #2c7be5;
--dot-accent-green: #e8f5e9;
--dot-accent-orange: #fff3e0;
--dot-accent-red: #ffcdd2;
}
:root[data-theme="light"] {
--bg-primary: #f8f9fa;
--bg-secondary: #e9ecef;
--bg-panel: #ffffff;
--bg-toolbar: #f1f3f5;
--border-color: #dee2e6;
--text-primary: #212529;
--text-secondary: #495057;
--accent-color: #2c7be5;
--accent-hover: #2463c2;
--preview-bg: #ffffff;
--preview-text: #212529;
--modal-bg: #ffffff;
--modal-border: #dee2e6;
--code-bg: #f8f9fa;
--code-border: #dee2e6;
--success-color: #10b981;
--error-color: #ef4444;
--warning-color: #f59e0b;
--quote-color: #6c757d;
--search-bg: #ffffff;
--search-border: #ced4da;
--search-highlight: rgba(44, 123, 229, 0.2);
--current-line-bg: rgba(44, 123, 229, 0.1);
--theme-icon: #6c757d;
--notification-shadow: 0 4px 12px rgba(0,0,0,0.1);
--panel-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
--modal-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
--dot-bg: #f0f7ff;
--dot-border: #2c7be5;
--dot-accent-green: #e6f7e9;
--dot-accent-orange: #fff8e6;
--dot-accent-red: #ffe6e6;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body { height: 100%; overflow: hidden; }
body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
background-color: var(--bg-primary);
color: var(--text-primary);
display: flex;
flex-direction: column;
transition: background-color 0.3s ease, color 0.3s ease;
line-height: 1.5;
}
/* ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ==================== */
.modal-backdrop {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(10, 12, 20, 0.75);
backdrop-filter: blur(8px);
display: flex;
justify-content: center;
align-items: center;
z-index: 1000;
opacity: 0;
visibility: hidden;
transition: opacity 0.3s ease, visibility 0.3s ease;
}
.modal-backdrop.active {
opacity: 1;
visibility: visible;
}
.modal-content {
background: var(--modal-bg);
border: 1px solid var(--modal-border);
border-radius: 12px;
width: 90%;
max-width: 560px;
padding: 1.8rem;
position: relative;
box-shadow: var(--modal-shadow);
max-height: 85vh;
overflow-y: auto;
color: var(--text-primary);
transform: translateY(10px);
transition: transform 0.3s ease;
}
.modal-backdrop.active .modal-content {
transform: translateY(0);
}
.modal-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1.2rem;
padding-bottom: 0.8rem;
border-bottom: 1px solid var(--border-color);
}
.modal-title {
font-size: 1.4rem;
font-weight: 600;
display: flex;
align-items: center;
gap: 0.5rem;
}
.close-modal {
background: none;
border: none;
color: var(--text-secondary);
font-size: 1.4rem;
cursor: pointer;
padding: 0.2rem;
transition: color 0.2s;
width: 32px;
height: 32px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
}
.close-modal:hover {
color: var(--accent-color);
background: rgba(77, 157, 224, 0.1);
}
/* ==================== –®–ê–ü–ö–ê ==================== */
.header {
background-color: rgba(34, 40, 55, 0.85);
backdrop-filter: blur(6px);
border-bottom: 1px solid var(--border-color);
padding: 0.6rem 1.5rem;
display: flex;
justify-content: space-between;
align-items: center;
z-index: 100;
flex-shrink: 0;
box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}
.header[data-theme="light"] {
background-color: rgba(255, 255, 255, 0.92);
box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}
.header-title {
font-size: 1.35rem;
font-weight: 700;
display: flex;
align-items: center;
gap: 0.75rem;
background: linear-gradient(45deg, var(--accent-color), #6cb4ee);
-webkit-background-clip: text;
background-clip: text;
color: transparent;
text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.header-buttons {
display: flex;
gap: 0.75rem;
align-items: center;
}
.header-btn {
background: rgba(45, 52, 69, 0.6);
border: 1px solid var(--border-color);
color: var(--text-primary);
padding: 0.45rem 0.95rem;
border-radius: 8px;
font-size: 0.9rem;
cursor: pointer;
display: flex;
align-items: center;
gap: 0.5rem;
transition: all 0.25s ease;
font-weight: 500;
box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
}
.header-btn:hover {
background: rgba(77, 157, 224, 0.2);
border-color: var(--accent-color);
transform: translateY(-1px);
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
.theme-toggle-btn {
background: var(--bg-toolbar);
border: 1px solid var(--border-color);
width: 42px;
height: 42px;
border-radius: 10px;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.25s ease;
color: var(--theme-icon);
font-size: 1.1rem;
box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
}
.theme-toggle-btn:hover {
background: var(--accent-color);
color: white;
transform: rotate(20deg);
box-shadow: 0 4px 10px rgba(77, 157, 224, 0.3);
}
/* ==================== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ ==================== */
.main-container {
flex: 1;
display: flex;
padding: 0.8rem 1.2rem;
gap: 1rem;
overflow: hidden;
}
.content-area {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 1rem;
width: 100%;
height: 100%;
}
.panel {
background: var(--bg-panel);
border: 1px solid var(--border-color);
border-radius: 12px;
display: flex;
flex-direction: column;
overflow: hidden;
box-shadow: var(--panel-shadow);
transition: box-shadow 0.3s ease;
}
.panel:hover {
box-shadow: 0 6px 25px rgba(0, 0, 0, 0.3);
}
.toolbar {
background: var(--bg-toolbar);
border-bottom: 1px solid var(--border-color);
padding: 0.65rem 0.9rem;
display: flex;
gap: 0.6rem;
flex-wrap: wrap;
flex-shrink: 0;
justify-content: space-between;
align-items: center;
}
.toolbar-left, .toolbar-right {
display: flex;
gap: 0.6rem;
align-items: center;
flex-wrap: wrap;
}
.tool-btn {
background: rgba(255, 255, 255, 0.07);
border: 1px solid var(--border-color);
color: var(--text-primary);
padding: 0.42rem 0.7rem;
border-radius: 8px;
cursor: pointer;
transition: all 0.2s ease;
font-size: 0.86rem;
display: flex;
align-items: center;
gap: 0.4rem;
white-space: nowrap;
min-width: 80px;
font-weight: 500;
box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.tool-btn:hover {
background: rgba(77, 157, 224, 0.2);
border-color: var(--accent-color);
color: var(--accent-color);
transform: translateY(-1px);
box-shadow: 0 3px 6px rgba(0,0,0,0.15);
}
.tool-btn:active {
transform: translateY(0);
}
.tool-btn.danger {
background: rgba(229, 115, 115, 0.15);
border-color: #d32f2f;
color: #ffcdd2;
}
.tool-btn.danger:hover {
background: rgba(211, 47, 47, 0.25);
border-color: #c62828;
color: white;
}
/* ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –í–ö–õ–ê–î–û–ö (–ú–û–ë–ò–õ–¨–ù–´–ô) ==================== */
.view-toggle {
display: none;
background: var(--bg-toolbar);
border-bottom: 1px solid var(--border-color);
padding: 0.5rem;
text-align: center;
}
.view-toggle-btn {
background: none;
border: 1px solid var(--border-color);
color: var(--text-secondary);
padding: 0.5rem 1rem;
margin: 0 0.25rem;
border-radius: 6px;
cursor: pointer;
transition: all 0.2s;
font-weight: 500;
}
.view-toggle-btn.active {
background: var(--accent-color);
color: white;
border-color: var(--accent-color);
}
.view-toggle-btn:hover:not(.active) {
background: rgba(77, 157, 224, 0.15);
color: var(--accent-color);
}
/* ==================== –ü–û–ò–°–ö ==================== */
.search-container {
display: none;
background: var(--search-bg);
border-bottom: 1px solid var(--border-color);
padding: 0.6rem 0.9rem;
flex-shrink: 0;
animation: slideDown 0.25s ease;
}
@keyframes slideDown {
from { opacity: 0; transform: translateY(-10px); }
to { opacity: 1; transform: translateY(0); }
}
.search-box {
display: flex;
gap: 0.6rem;
max-width: 400px;
}
.search-input {
background: var(--bg-primary);
border: 1px solid var(--search-border);
color: var(--text-primary);
padding: 0.45rem 0.8rem;
border-radius: 6px;
font-size: 0.9rem;
flex: 1;
transition: border-color 0.2s;
}
.search-input:focus {
outline: none;
border-color: var(--accent-color);
box-shadow: 0 0 0 2px rgba(77, 157, 224, 0.2);
}
.search-btn, .search-close {
background: var(--accent-color);
color: white;
border: none;
width: 36px;
height: 36px;
border-radius: 6px;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.2s;
font-size: 0.9rem;
box-shadow: 0 2px 4px rgba(0,0,0,0.15);
}
.search-btn:hover {
background: var(--accent-hover);
transform: translateY(-1px);
box-shadow: 0 3px 6px rgba(0,0,0,0.2);
}
.search-close {
background: #e57373;
margin-left: 0.4rem;
}
.search-close:hover {
background: #d32f2f;
transform: translateY(-1px);
box-shadow: 0 3px 6px rgba(229, 115, 115, 0.3);
}
.search-status {
color: var(--text-secondary);
font-size: 0.85rem;
margin-left: 0.8rem;
display: flex;
align-items: center;
gap: 0.3rem;
}
/* ==================== –†–ï–î–ê–ö–¢–û–† ==================== */
.editor-container {
position: relative;
flex: 1;
display: flex;
flex-direction: column;
overflow: hidden;
}
.editor-wrapper {
position: relative;
flex: 1;
overflow: hidden;
}
.editor {
flex: 1;
padding: 1.2rem;
font-family: 'Consolas', 'Courier New', monospace;
font-size: 14px;
line-height: 1.55;
resize: none;
background: var(--bg-primary);
color: var(--text-primary);
border: none;
outline: none;
caret-color: var(--accent-color);
overflow: auto;
transition: background-color 0.3s ease, color 0.3s ease;
width: 100%;
height: 100%;
}
.editor:focus {
box-shadow: inset 0 0 0 2px rgba(77, 157, 224, 0.3);
}
/* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ */
.editor.current-line {
background-color: var(--current-line-bg);
}
/* ==================== –ü–†–ï–î–ü–†–û–°–ú–û–¢–† ==================== */
.preview-header {
background: var(--bg-toolbar);
border-bottom: 1px solid var(--border-color);
padding: 0.65rem 1rem;
display: flex;
align-items: center;
gap: 1.2rem;
justify-content: space-between;
height: 48px;
flex-shrink: 0;
}
.font-size-control {
display: flex;
align-items: center;
gap: 0.65rem;
}
.font-size-control label {
font-size: 0.9rem;
color: var(--text-secondary);
font-weight: 500;
}
.font-size-select {
background: var(--bg-primary);
border: 1px solid var(--border-color);
color: var(--text-primary);
padding: 0.35rem 0.6rem;
border-radius: 6px;
font-size: 0.9rem;
min-width: 70px;
transition: border-color 0.2s;
}
.font-size-select:focus {
outline: none;
border-color: var(--accent-color);
box-shadow: 0 0 0 2px rgba(77, 157, 224, 0.2);
}
.document-input-group {
display: flex;
align-items: center;
background: var(--bg-primary);
border: 1px solid var(--border-color);
border-radius: 8px;
overflow: hidden;
max-width: 220px;
}
.document-input-group input {
background: transparent;
border: none;
color: var(--text-primary);
padding: 0.45rem 0.8rem;
font-size: 0.95rem;
outline: none;
width: 150px;
min-width: 100px;
font-weight: 500;
}
.document-extension {
color: var(--text-secondary);
padding: 0.45rem 0.8rem;
font-size: 0.95rem;
border-left: 1px solid var(--border-color);
min-width: 42px;
text-align: center;
background: rgba(0, 0, 0, 0.03);
}
.download-btn {
background: linear-gradient(45deg, var(--accent-color), #3a85c9);
color: white;
border: 1px solid var(--accent-color);
padding: 0.45rem 1.1rem;
border-radius: 8px;
font-size: 0.95rem;
cursor: pointer;
display: flex;
align-items: center;
gap: 0.55rem;
transition: all 0.25s ease;
font-weight: 600;
box-shadow: 0 2px 6px rgba(0,0,0,0.15);
min-width: 90px;
justify-content: center;
}
.download-btn:hover {
background: linear-gradient(45deg, var(--accent-hover), #2a75b5);
transform: translateY(-1px);
box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}
.download-btn:active {
transform: translateY(0);
}
.preview {
flex: 1;
padding: 1.5rem;
overflow: auto;
display: flex;
align-items: flex-start;
justify-content: center;
background: var(--bg-secondary);
transition: background-color 0.3s ease;
}
.preview-content {
background: var(--preview-bg);
color: var(--preview-text);
padding: 2.2rem 1.8rem;
line-height: 1.65;
font-size: 14px;
border-radius: 12px;
box-shadow: 0 5px 25px rgba(0, 0, 0, 0.08);
width: 78%;
min-width: 320px;
max-width: 820px;
transition: all 0.3s ease;
position: relative;
}
.preview-content::before {
content: "";
position: absolute;
top: 0;
left: 0;
right: 0;
height: 4px;
background: linear-gradient(90deg, var(--accent-color), #6cb4ee);
border-radius: 12px 12px 0 0;
}
/* –°—Ç–∏–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—É–ª—É—á—à–µ–Ω–Ω—ã–µ) */
.preview-content h1 {
font-size: 2.1em;
margin-bottom: 0.55em;
border-bottom: 2px solid #eee;
padding-bottom: 0.35em;
font-weight: 700;
line-height: 1.2;
color: #1a1f2b;
}
.preview-content h2 {
font-size: 1.65em;
margin: 1.1em 0 0.6em;
font-weight: 600;
color: #2c3e50;
}
.preview-content h3 {
font-size: 1.35em;
margin: 1em 0 0.5em;
font-weight: 600;
color: #2c3e50;
}
.preview-content p {
margin: 0.9em 0;
line-height: 1.65;
}
.preview-content ul,
.preview-content ol {
padding-left: 1.8rem;
margin: 1rem 0;
}
.preview-content li {
margin-bottom: 0.5rem;
line-height: 1.6;
}
.preview-content blockquote {
border-left: 4px solid var(--accent-color);
padding-left: 1.2rem;
color: var(--quote-color);
font-style: italic;
margin: 1.4rem 0;
background: rgba(77, 157, 224, 0.06);
padding: 1rem 1.2rem;
border-radius: 0 6px 6px 0;
position: relative;
}
.preview-content blockquote::before {
content: """;
position: absolute;
left: -10px;
top: -5px;
font-size: 4rem;
color: rgba(77, 157, 224, 0.15);
font-family: Georgia, serif;
line-height: 1;
}
.preview-content code:not(pre code) {
background: var(--code-bg);
border: 1px solid var(--code-border);
border-radius: 4px;
padding: 0.2rem 0.4rem;
font-family: 'Consolas', 'Courier New', monospace;
font-size: 0.93em;
color: #e06c75;
}
.preview-content pre {
background: var(--code-bg);
border: 1px solid var(--code-border);
border-radius: 8px;
padding: 1.2rem;
margin: 1.4rem 0;
overflow-x: auto;
font-family: 'Consolas', 'Courier New', monospace;
font-size: 0.92em;
line-height: 1.5;
box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.preview-content pre code {
background: none;
border: none;
padding: 0;
font-size: inherit;
color: var(--preview-text);
line-height: 1.5;
}
/* DOT diagrams (—É–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏) */
.dot-diagram-container {
text-align: center;
margin: 1.5rem 0;
background: var(--dot-bg);
padding: 20px;
border-radius: 10px;
border: 1px solid var(--dot-border);
overflow: hidden;
page-break-inside: avoid;
break-inside: avoid;
box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}
.dot-diagram-placeholder {
border: 2px dashed var(--dot-border);
border-radius: 10px;
padding: 25px;
background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
text-align: left;
}
.dot-diagram-title {
color: var(--dot-border);
font-weight: bold;
margin-bottom: 15px;
display: flex;
align-items: center;
gap: 10px;
font-size: 17px;
}
.dot-code {
background: white;
padding: 18px;
border-radius: 6px;
font-family: 'Courier New', monospace;
font-size: 13.5px;
white-space: pre-wrap;
overflow-x: auto;
border: 1px solid var(--code-border);
box-shadow: 0 2px 6px rgba(0,0,0,0.06);
line-height: 1.45;
margin: 10px 0;
color: #495057;
}
.dot-note {
margin-top: 15px;
padding: 14px;
background: #e3f2fd;
border-radius: 6px;
font-size: 13.5px;
color: #1565c0;
border-left: 4px solid var(--accent-color);
line-height: 1.5;
}
.dot-note strong {
color: var(--accent-color);
}
/* KaTeX —Ñ–æ—Ä–º—É–ª—ã */
.katex {
font-size: 1.15em;
font-weight: 500;
}
.katex-display {
margin: 1.2em 0 !important;
overflow: auto hidden;
padding: 0.6em 0;
text-align: center;
}
.katex-display > .katex {
display: inline-block;
text-align: center;
max-width: 100%;
}
/* –¢–∞–±–ª–∏—Ü—ã */
.preview-content table {
width: 100%;
border-collapse: collapse;
margin: 1.4rem 0;
box-shadow: 0 1px 3px rgba(0,0,0,0.08);
border-radius: 8px;
overflow: hidden;
}
.preview-content th,
.preview-content td {
border: 1px solid #999999;
padding: 0.75rem 1rem;
text-align: left;
line-height: 1.4;
}
.preview-content th {
background-color: #f6f8fa;
font-weight: 600;
color: #2c3e50;
}
.preview-content tr:nth-child(even) {
background-color: rgba(0, 0, 0, 0.02);
}
/* –†–∞–∑—Ä—ã–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
.preview-content .page-break {
page-break-after: always;
break-after: page;
height: 1px;
margin: 2.2rem 0;
border: none;
border-top: 1px dashed #aaa;
width: 100%;
position: relative;
text-align: center;
}
.preview-content .page-break::after {
content: "‚Ä¢ ‚Ä¢ ‚Ä¢";
position: absolute;
top: -10px;
left: 50%;
transform: translateX(-50%);
background: var(--preview-bg);
padding: 0 10px;
color: var(--text-secondary);
font-size: 1.2em;
}
/* ==================== –ü–û–î–í–ê–õ ==================== */
.footer-container {
display: flex;
justify-content: space-between;
align-items: center;
padding: 0.7rem 1.5rem 0.8rem;
font-size: 0.92rem;
color: var(--text-secondary);
border-top: 1px solid var(--border-color);
background: var(--bg-toolbar);
flex-shrink: 0;
margin-top: 0.8rem;
}
.footer-made-by {
font-weight: 600;
color: var(--accent-color);
display: flex;
align-items: center;
gap: 0.4rem;
}
.footer-slogan {
font-weight: 500;
color: var(--text-secondary);
font-style: italic;
}
/* ==================== –°–ö–†–û–õ–õ–ë–ê–†–´ ==================== */
::-webkit-scrollbar {
width: 8px;
height: 8px;
}
::-webkit-scrollbar-track {
background: var(--bg-primary);
border-radius: 4px;
}
::-webkit-scrollbar-thumb {
background: var(--border-color);
border-radius: 4px;
border: 2px solid transparent;
background-clip: content-box;
}
::-webkit-scrollbar-thumb:hover {
background: #4a5265;
}
/* ==================== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==================== */
#notification {
position: fixed;
bottom: 25px;
right: 25px;
background: white;
color: #1a1f2b;
padding: 14px 20px;
border-radius: 12px;
display: flex;
align-items: center;
gap: 12px;
z-index: 2000;
box-shadow: var(--notification-shadow);
transform: translateX(400px);
opacity: 0;
transition: all 0.35s cubic-bezier(0.16, 1, 0.3, 1);
max-width: 350px;
border-left: 4px solid var(--success-color);
}
#notification.show {
transform: translateX(0);
opacity: 1;
}
#notification.error {
border-left-color: var(--error-color);
background: #fff5f5;
}
#notification.warning {
border-left-color: var(--warning-color);
background: #fff9e6;
}
#notification i {
font-size: 1.3rem;
}
#notification.error i {
color: var(--error-color);
}
#notification.warning i {
color: var(--warning-color);
}
#notification.success i {
color: var(--success-color);
}
#notification button {
background: none;
border: none;
color: #6c757d;
font-size: 1.2rem;
cursor: pointer;
padding: 0 5px;
display: flex;
margin-left: 8px;
border-radius: 4px;
transition: all 0.2s;
}
#notification button:hover {
color: var(--text-primary);
background: rgba(0,0,0,0.05);
}
/* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
.notification-progress {
position: absolute;
bottom: 0;
left: 0;
height: 3px;
background: var(--accent-color);
border-radius: 0 0 12px 12px;
width: 100%;
animation: progress 5s linear forwards;
animation-play-state: running;
}
#notification:hover .notification-progress {
animation-play-state: paused;
}
@keyframes progress {
from { width: 100%; }
to { width: 0%; }
}
/* ==================== PDF LOADER ==================== */
.pdf-loader {
position: fixed;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: rgba(10, 12, 20, 0.82);
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
z-index: 2000;
opacity: 0;
pointer-events: none;
transition: opacity 0.4s ease;
backdrop-filter: blur(4px);
}
.pdf-loader.active {
opacity: 1;
pointer-events: all;
}
.loader-content {
background: var(--modal-bg);
padding: 40px 50px;
border-radius: 20px;
box-shadow: 0 15px 40px rgba(0,0,0,0.35);
text-align: center;
max-width: 400px;
width: 90%;
border: 1px solid var(--modal-border);
}
.loader-spinner {
position: relative;
width: 70px;
height: 70px;
margin: 0 auto 25px;
}
.loader-spinner-inner {
position: absolute;
width: 100%;
height: 100%;
border-radius: 50%;
border: 4px solid var(--border-color);
border-top-color: var(--accent-color);
animation: spin 0.9s linear infinite;
box-shadow: 0 0 15px rgba(77, 157, 224, 0.4);
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
.loader-text {
font-size: 22px;
color: var(--text-primary);
font-weight: 600;
margin-top: 10px;
letter-spacing: -0.5px;
}
.loader-subtext {
font-size: 15px;
color: var(--text-secondary);
margin-top: 8px;
font-weight: 400;
}
/* ==================== DROPDOWN –ú–ï–ù–Æ ==================== */
.dropdown-menu {
position: absolute;
background: var(--modal-bg);
border: 1px solid var(--border-color);
border-radius: 10px;
padding: 8px;
box-shadow: 0 8px 25px rgba(0,0,0,0.2);
z-index: 100;
transform: translateY(10px);
opacity: 0;
pointer-events: none;
transition: all 0.25s ease;
min-width: 220px;
top: 100%;
left: 0;
margin-top: 5px;
}
.dropdown-menu.active {
opacity: 1;
pointer-events: all;
transform: translateY(0);
}
.dropdown-item {
padding: 10px 14px;
border-radius: 8px;
cursor: pointer;
transition: all 0.2s;
white-space: nowrap;
display: flex;
align-items: center;
gap: 10px;
font-size: 0.92rem;
font-weight: 500;
}
.dropdown-item:hover {
background: rgba(77, 157, 224, 0.15);
color: var(--accent-color);
transform: translateX(3px);
}
.dropdown-item i {
width: 20px;
text-align: center;
font-size: 0.95em;
}
/* ==================== –¢–ê–ë–õ–ò–ß–ù–´–ô –†–ï–î–ê–ö–¢–û–† ==================== */
.table-grid {
display: grid;
gap: 3px;
margin: 15px 0;
background: var(--border-color);
padding: 3px;
border-radius: 8px;
overflow: hidden;
}
.table-cell {
background: var(--bg-panel);
border: none;
padding: 10px;
font-family: 'Consolas', monospace;
font-size: 14px;
text-align: center;
color: var(--text-primary);
border-radius: 4px;
transition: all 0.2s;
min-width: 100px;
}
.table-cell:focus {
outline: 2px solid var(--accent-color);
background: var(--input-bg);
}
.table-controls {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 10px;
margin-top: 15px;
}
.table-controls button {
padding: 10px;
background: var(--accent-color);
color: white;
border: none;
border-radius: 8px;
cursor: pointer;
font-weight: 500;
transition: all 0.2s;
display: flex;
align-items: center;
justify-content: center;
gap: 6px;
box-shadow: 0 2px 4px rgba(0,0,0,0.15);
}
.table-controls button:hover {
background: var(--accent-hover);
transform: translateY(-1px);
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
.table-controls button.danger {
background: #e57373;
}
.table-controls button.danger:hover {
background: #d32f2f;
}
/* ==================== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ==================== */
@media (max-width: 1100px) {
.content-area { grid-template-columns: 1fr; }
.preview-content { width: 92%; padding: 1.8rem 1.5rem; }
.main-container { padding: 0.8rem 1rem 0.5rem; }
.header { padding: 0.5rem 1rem; }
.header-title { font-size: 1.2rem; }
.document-input-group { max-width: 180px; }
.document-input-group input { width: 120px; font-size: 0.9rem; }
.document-extension { font-size: 0.9rem; min-width: 38px; }
.font-size-select { min-width: 65px; font-size: 0.88rem; padding: 0.3rem 0.5rem; }
.tool-btn { min-width: 70px; padding: 0.38rem 0.6rem; font-size: 0.85rem; }
.tool-btn span { display: none; }
.tool-btn i { margin: 0; }
}
@media (max-width: 768px) {
.view-toggle { display: block; }
.content-area { display: none; }
.content-area.active { display: block; width: 100%; }
.toolbar { flex-direction: column; align-items: stretch; gap: 8px; }
.toolbar-left, .toolbar-right { width: 100%; justify-content: space-between; }
.preview-header { flex-direction: column; align-items: stretch; gap: 12px; height: auto; }
.font-size-control, .document-actions { width: 100%; justify-content: space-between; }
.download-btn { width: 100%; padding: 0.55rem; font-size: 1.05rem; }
.footer-container { flex-direction: column; gap: 8px; text-align: center; }
.modal-content { width: 95%; padding: 1.5rem; }
.header-buttons { gap: 0.4rem; }
.header-btn { padding: 0.4rem 0.6rem; font-size: 0.85rem; }
.header-btn span { display: none; }
.theme-toggle-btn { width: 38px; height: 38px; }
}
@media (max-width: 480px) {
.preview-content { width: 95%; padding: 1.5rem 1.2rem; font-size: 13.5px; }
.preview-content h1 { font-size: 1.9em; }
.preview-content h2 { font-size: 1.5em; }
.editor { font-size: 13.5px; padding: 0.9rem; }
.tool-btn { min-width: 60px; padding: 0.35rem 0.5rem; font-size: 0.8rem; }
.search-box { width: 100%; }
.search-status { display: none; }
.document-input-group { max-width: 150px; }
.document-input-group input { width: 90px; font-size: 0.85rem; }
.document-extension { font-size: 0.85rem; min-width: 35px; padding: 0.4rem 0.6rem; }
}
</style>
</head>
<body>
<!-- Modals -->
<div class="modal-backdrop" id="modalInfo">
<div class="modal-content">
<div class="modal-header">
<div class="modal-title">
<i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
</div>
<button class="close-modal">&times;</button>
</div>
<div class="modal-body">
<h2><i class="fas fa-file-export"></i> Markdown to PDF Pro</h2>
<p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è Markdown –≤ PDF —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:</p>
<ul>
<li>–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
<li>–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º—É–ª —á–µ—Ä–µ–∑ KaTeX</li>
<li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ DOT-–¥–∏–∞–≥—Ä–∞–º–º (Graphviz) - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ª–æ–∫–∞–ª—å–Ω–æ!</li>
<li>–°–≤–µ—Ç–ª–∞—è –∏ —Ç—ë–º–Ω–∞—è —Ç–µ–º—ã</li>
<li>–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
<li>–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É</li>
<li>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü</li>
<li>–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</li>
</ul>
<blockquote>
<p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>```dot ... ```</code> –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º Graphviz.</p>
<p>–ù–∞–∂–º–∏—Ç–µ <code>Ctrl+F</code> –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É.</p>
</blockquote>
<h2><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h2>
<div style="display: flex; gap: 20px; margin-top: 15px;">
<div>
<div style="font-size: 28px; font-weight: bold; color: var(--accent-color);" id="statDownloads">0</div>
<div style="font-size: 13px; color: var(--text-secondary);">PDF —Å–∫–∞—á–∞–Ω–æ</div>
</div>
<div>
<div style="font-size: 28px; font-weight: bold; color: var(--accent-color);" id="statChars">0</div>
<div style="font-size: 13px; color: var(--text-secondary);">–°–∏–º–≤–æ–ª–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-backdrop" id="modalThank">
<div class="modal-content">
<div class="modal-header">
<div class="modal-title">
<i class="fas fa-heart"></i> –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å
</div>
<button class="close-modal">&times;</button>
</div>
<div class="modal-body">
<h2><i class="fas fa-code"></i> –°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é</h2>
<p>–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. –ê–≤—Ç–æ—Ä –≤–ª–æ–∂–∏–ª –º–Ω–æ–≥–æ —É—Å–∏–ª–∏–π –≤ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
<div style="background: var(--bg-secondary); border-radius: 10px; padding: 15px; margin: 20px 0; border: 1px solid var(--border-color);">
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
<i class="fab fa-github" style="font-size: 1.8rem; color: var(--accent-color);"></i>
<div>
<div style="font-weight: 600; font-size: 1.1rem;">Aurum2347</div>
<div style="color: var(--text-secondary); font-size: 0.95rem;">GitHub –ø—Ä–æ—Ñ–∏–ª—å –∞–≤—Ç–æ—Ä–∞</div>
</div>
</div>
<a href="https://github.com/Aurum2347" target="_blank" style="display: inline-block; background: var(--accent-color); color: white; padding: 10px 15px; border-radius: 8px; text-decoration: none; font-weight: 600; margin-top: 10px; text-align: center; width: 100%;">
<i class="fab fa-github"></i> –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ GitHub
</a>
</div>
<h3 style="margin: 25px 0 15px;"><i class="fas fa-star"></i> –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</h3>
<ul>
<li>–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞</li>
<li>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</li>
<li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π - –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ –¥–∞–∂–µ —Å –±–æ–ª—å—à–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏</li>
<li>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω - —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Ç—ë–º–Ω–æ–π —Ç–µ–º–æ–π</li>
<li>–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Graphviz –∏ KaTeX</li>
</ul>
<div style="margin-top: 25px; padding-top: 15px; border-top: 1px solid var(--border-color); text-align: center;">
<div style="font-size: 3.5rem; margin-bottom: 10px;">‚ù§Ô∏è</div>
<div style="font-weight: 600; font-size: 1.3rem; margin-bottom: 5px;">–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ!</div>
<div style="color: var(--text-secondary);">–í–∞—à–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</div>
</div>
</div>
</div>
</div>
<!-- Table Modal -->
<div class="modal-backdrop" id="tableModal">
<div class="modal-content">
<div class="modal-header">
<div class="modal-title">
<i class="fas fa-table"></i> –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É
</div>
<button class="close-modal">&times;</button>
</div>
<div class="modal-body">
<p style="margin-bottom: 15px;">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —è—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2 —Å—Ç—Ä–æ–∫–∏ √ó 3 —Å—Ç–æ–ª–±—Ü–∞)</p>
<div class="table-editor">
<div class="table-grid" id="tableGrid" style="grid-template-columns: repeat(3, 1fr);"></div>
</div>
<div class="table-controls">
<button id="addRowBtn">
<i class="fas fa-plus"></i> –°—Ç—Ä–æ–∫–∞
</button>
<button id="addColBtn">
<i class="fas fa-plus"></i> –°—Ç–æ–ª–±–µ—Ü
</button>
<button id="removeRowBtn" class="danger">
<i class="fas fa-minus"></i> –°—Ç—Ä–æ–∫–∞
</button>
<button id="removeColBtn" class="danger">
<i class="fas fa-minus"></i> –°—Ç–æ–ª–±–µ—Ü
</button>
</div>
<button id="insertTableConfirm" style="width:100%; margin-top:20px; padding: 12px; background: linear-gradient(45deg, var(--accent-color), #3a85c9); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 1.05rem;">
<i class="fas fa-table"></i> –í—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ –¥–æ–∫—É–º–µ–Ω—Ç
</button>
<div style="margin-top: 15px; padding: 12px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-color); font-size: 0.9rem;">
<i class="fas fa-lightbulb" style="color: var(--accent-color); margin-right: 5px;"></i>
–°–æ–≤–µ—Ç: –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –≤—ã –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –µ—ë –ø—Ä—è–º–æ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ Markdown.
</div>
</div>
</div>
</div>
<!-- Header -->
<div class="header">
<div class="header-title">
<i class="fas fa-file-pdf"></i> Markdown2PDF Pro
</div>
<div class="header-buttons">
<button class="header-btn" data-modal="modalInfo">
<i class="fas fa-info-circle"></i> <span>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</span>
</button>
<button class="header-btn" data-modal="modalThank">
<i class="fas fa-heart"></i> <span>–ê–≤—Ç–æ—Ä</span>
</button>
<div class="theme-toggle-btn" id="themeToggle">
<i class="fas fa-moon"></i>
</div>
</div>
</div>
<!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
<div class="view-toggle">
<button class="view-toggle-btn active" data-view="editor">
<i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–æ—Ä
</button>
<button class="view-toggle-btn" data-view="preview">
<i class="fas fa-eye"></i> –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
</button>
</div>
<!-- Main Content -->
<div class="main-container">
<div class="content-area active" id="editorView">
<div class="panel">
<div class="toolbar">
<div class="toolbar-left">
<div style="position: relative;">
<button class="tool-btn" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫" id="insertHeading">
<i class="fas fa-heading"></i> <span>–ó–∞–≥–æ–ª–æ–≤–æ–∫</span>
</button>
<div class="dropdown-menu" id="headingMenu">
<div class="dropdown-item" onclick="insertTextAtCursor('–ó–∞–≥–æ–ª–æ–≤–æ–∫ 1', '# ', '')">
<i class="fas fa-heading"></i> <pre># –ó–∞–≥–æ–ª–æ–≤–æ–∫ 1</pre>
</div>
<div class="dropdown-item" onclick="insertTextAtCursor('–ó–∞–≥–æ–ª–æ–≤–æ–∫ 2', '## ', '')">
<i class="fas fa-heading"></i> <pre>## –ó–∞–≥–æ–ª–æ–≤–æ–∫ 2</pre>
</div>
<div class="dropdown-item" onclick="insertTextAtCursor('–ó–∞–≥–æ–ª–æ–≤–æ–∫ 3', '### ', '')">
<i class="fas fa-heading"></i> <pre>### –ó–∞–≥–æ–ª–æ–≤–æ–∫ 3</pre>
</div>
</div>
</div>
<button class="tool-btn" title="–ñ–∏—Ä–Ω—ã–π" data-format="bold">
<i class="fas fa-bold"></i> <span>–ñ–∏—Ä–Ω—ã–π</span>
</button>
<button class="tool-btn" title="–ö—É—Ä—Å–∏–≤" data-format="italic">
<i class="fas fa-italic"></i> <span>–ö—É—Ä—Å–∏–≤</span>
</button>
<button class="tool-btn" title="–°—Å—ã–ª–∫–∞" data-format="link">
<i class="fas fa-link"></i> <span>–°—Å—ã–ª–∫–∞</span>
</button>
<button class="tool-btn" title="–¢–∞–±–ª–∏—Ü–∞" id="insertTableBtn">
<i class="fas fa-table"></i> <span>–¢–∞–±–ª–∏—Ü–∞</span>
</button>
<button class="tool-btn" title="–ü–æ–∏—Å–∫" id="toggleSearch">
<i class="fas fa-search"></i> <span>–ü–æ–∏—Å–∫</span>
</button>
<button class="tool-btn danger" title="–û—á–∏—Å—Ç–∏—Ç—å" id="clearEditor">
<i class="fas fa-trash-alt"></i> <span>–û—á–∏—Å—Ç–∏—Ç—å</span>
</button>
</div>
<div class="toolbar-right">
<button class="tool-btn" title="–°–ø–∏—Å–æ–∫" data-format="list">
<i class="fas fa-list"></i> <span>–°–ø–∏—Å–æ–∫</span>
</button>
<button class="tool-btn" title="–ö–æ–¥" data-format="code">
<i class="fas fa-code"></i> <span>–ö–æ–¥</span>
</button>
<button class="tool-btn" title="–¶–∏—Ç–∞—Ç–∞" data-format="quote">
<i class="fas fa-quote-right"></i> <span>–¶–∏—Ç–∞—Ç–∞</span>
</button>
<button class="tool-btn" title="–†–∞–∑—Ä—ã–≤" data-format="pageBreak">
<i class="fas fa-scissors"></i> <span>–†–∞–∑—Ä—ã–≤</span>
</button>
</div>
</div>
<!-- –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ -->
<div class="search-container" id="searchContainer">
<div style="display: flex; align-items: center; gap: 1rem; width: 100%;">
<div class="search-box">
<input type="text" class="search-input" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ...">
<button class="search-btn" id="searchNext">
<i class="fas fa-arrow-down"></i>
</button>
<button class="search-close" id="closeSearch">
<i class="fas fa-times"></i>
</button>
</div>
<div class="search-status" id="searchStatus">0 –∏–∑ 0</div>
</div>
</div>
<div class="editor-container">
<div class="editor-wrapper">
<textarea class="editor" id="markdownEditor" placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –≤–∞—à –¥–æ–∫—É–º–µ–Ω—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown..."># –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Markdown2PDF Pro!
–≠—Ç–æ —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Markdown –≤ PDF. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
## üî• –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **–°–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è —Ç–µ–º–∞** - –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ—Å—å –≤ —à–∞–ø–∫–µ
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫** - –Ω–∞–∂–º–∏—Ç–µ Ctrl+F –∏–ª–∏ –∫–Ω–æ–ø–∫—É "–ü–æ–∏—Å–∫"
- **–£–ª—É—á—à–µ–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç PDF** - –∏–¥–µ–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü** - –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ
- **–û—á–∏—Å—Ç–∫–∞ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤** –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
- **–ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Graphviz** - –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –¥–∞–∂–µ –ª–æ–∫–∞–ª—å–Ω–æ!
- **–ù–∞–¥–µ–∂–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ñ–æ—Ä–º—É–ª** —á–µ—Ä–µ–∑ KaTeX
## üìê –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã
–ò–Ω–ª–∞–π–Ω —Ñ–æ—Ä–º—É–ª–∞: $E = mc^2$
–ë–ª–æ—á–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:
$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$
–°–∏—Å—Ç–µ–º–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏–π:
$$
\begin{cases}
x + y = 5 \\
2x - y = 1
\end{cases}
$$
## üìä –¢–∞–±–ª–∏—Ü—ã
| –°–∏–Ω—Ç–∞–∫—Å–∏—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–µ—Å—Ç |
| --------- | -------- | ---- |
| –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã | –î–∞–Ω–Ω—ã–µ |
| –Ø—á–µ–π–∫–∞ | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —è—á–µ–π–∫–∏ | –î–∞–Ω–Ω—ã–µ |
| –°—Ç—Ä–æ–∫–∞ | –î–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä–æ–∫–µ | –î–∞–Ω–Ω—ã–µ |
## üí° –¶–∏—Ç–∞—Ç–∞
> "–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –±—É–¥—É—â–µ–µ ‚Äî –∏–∑–æ–±—Ä–µ—Å—Ç–∏ –µ–≥–æ."
> ‚Äî –ê–ª–∞–Ω –ö–µ–π
## üîó –°—Å—ã–ª–∫–∏
[–ü–æ—Å–µ—Ç–∏—Ç–µ GitHub –∞–≤—Ç–æ—Ä–∞](https://github.com/Aurum2347)
## üìÅ –ë–ª–æ–∫-—Å—Ö–µ–º–∞ DOT
```dot
digraph G {
rankdir=LR;
node [shape=rectangle, style=filled, fillcolor="#e3f2fd", color="#2c7be5"];
Start [label="–ù–∞—á–∞–ª–æ", fillcolor="#bbdefb"];
Process1 [label="–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö"];
Decision [shape=diamond, label="–£—Å–ª–æ–≤–∏–µ?", fillcolor="#e8f5e9"];
Process2 [label="–î–µ–π—Å—Ç–≤–∏–µ 1", fillcolor="#e8f5e9"];
Process3 [label="–î–µ–π—Å—Ç–≤–∏–µ 2", fillcolor="#fff3e0"];
End [label="–ö–æ–Ω–µ—Ü", fillcolor="#ffcdd2"];
Start -> Process1;
Process1 -> Decision;
Decision -> Process2 [label="–î–∞"];
Decision -> Process3 [label="–ù–µ—Ç"];
Process2 -> End;
Process3 -> End;
}
```
## üåê –°–µ—Ç–µ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
```dot
graph Network {
rankdir=LR;
node [shape=circle, style=filled, fillcolor="#e3f2fd", color="#2c7be5", fontname="Arial"];
edge [color="#546e7a", penwidth=1.5];
Server1 [label="–°–µ—Ä–≤–µ—Ä 1", fillcolor="#bbdefb"];
Server2 [label="–°–µ—Ä–≤–µ—Ä 2", fillcolor="#bbdefb"];
DB [label="–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö", fillcolor="#c8e6c9"];
Cache [label="–ö—ç—à", fillcolor="#fff3e0"];
Client [label="–ö–ª–∏–µ–Ω—Ç", fillcolor="#ffcdd2"];
Client -- Server1 [label="HTTP"];
Client -- Server2 [label="HTTPS"];
Server1 -- DB [label="SQL"];
Server2 -- DB;
Server1 -- Cache [label="Redis"];
Server2 -- Cache;
}
```
## üìÑ –†–∞–∑—Ä—ã–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
–¢–µ–∫—Å—Ç –¥–æ —Ä–∞–∑—Ä—ã–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...
---
–¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Ä–∞–∑—Ä—ã–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤!
## ‚ú® –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã. –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è!</textarea>
</div>
</div>
</div>
</div>
<div class="content-area" id="previewView">
<div class="panel">
<div class="preview-header">
<div class="font-size-control">
<label for="fontSizeSelect"><i class="fas fa-text-size"></i> –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞:</label>
<select class="font-size-select" id="fontSizeSelect">
<option value="12">12px</option>
<option value="14" selected>14px</option>
<option value="16">16px</option>
<option value="18">18px</option>
</select>
</div>
<div class="document-actions" style="display:flex;gap:1rem;align-items:center;">
<div class="document-input-group">
<input type="text" id="documentName" value="document" maxlength="50">
<div class="document-extension">.pdf</div>
</div>
<button class="download-btn" id="downloadPdf">
<i class="fas fa-download"></i> <span>–°–∫–∞—á–∞—Ç—å PDF</span>
</button>
</div>
</div>
<div class="preview">
<div class="preview-content" id="previewContent"></div>
</div>
<div class="footer-container">
<div>
<span class="footer-status">
<span class="status-dot" style="display:inline-block;width:8px;height:8px;background:#10b981;border-radius:50%;margin-right:6px;"></span> –ì–æ—Ç–æ–≤–æ –∫ —ç–∫—Å–ø–æ—Ä—Ç—É
</span>
</div>
<div>
<span class="footer-made-by">
<i class="fas fa-code"></i> By Aurum2347
</span>
</div>
<div>
<span class="footer-slogan">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º</span>
</div>
</div>
</div>
</div>
</div>
<!-- Notification -->
<div id="notification">
<i class="fas fa-check-circle success"></i>
<span id="notificationText">–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!</span>
<button onclick="closeNotification()">&times;</button>
<div class="notification-progress"></div>
</div>
<!-- PDF Loader -->
<div class="pdf-loader">
<div class="loader-content">
<div class="loader-spinner">
<div class="loader-spinner-inner"></div>
</div>
<div class="loader-text">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF</div>
<div class="loader-subtext">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...</div>
</div>
</div>
<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/lib/marked.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
<script>
// ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
let graphvizInstance = null;
let isLocalFile = window.location.protocol === 'file:';
let currentSearchIndex = -1;
let searchResults = [];
let themeToggleBtn = null;
let editor = null;
let preview = null;
let downloadBtn = null;
let documentNameInput = null;
let fontSizeSelect = null;
let notification = null;
let pdfLoader = null;
let insertHeadingBtn = null;
let headingMenu = null;
let insertTableBtn = null;
let searchContainer = null;
let searchInput = null;
let searchNextBtn = null;
let closeSearchBtn = null;
let searchStatusEl = null;
let toggleSearchBtn = null;
let clearEditorBtn = null;
let downloadCount = 0;
let totalChars = 0;
let previewTimeout = null;
let currentView = 'editor'; // 'editor' or 'preview'

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ====================
document.addEventListener('DOMContentLoaded', async () => {
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ DOM
editor = document.getElementById('markdownEditor');
preview = document.getElementById('previewContent');
downloadBtn = document.getElementById('downloadPdf');
documentNameInput = document.getElementById('documentName');
fontSizeSelect = document.getElementById('fontSizeSelect');
notification = document.getElementById('notification');
pdfLoader = document.querySelector('.pdf-loader');
insertHeadingBtn = document.getElementById('insertHeading');
headingMenu = document.getElementById('headingMenu');
insertTableBtn = document.getElementById('insertTableBtn');
searchContainer = document.getElementById('searchContainer');
searchInput = document.getElementById('searchInput');
searchNextBtn = document.getElementById('searchNext');
closeSearchBtn = document.getElementById('closeSearch');
searchStatusEl = document.getElementById('searchStatus');
toggleSearchBtn = document.getElementById('toggleSearch');
clearEditorBtn = document.getElementById('clearEditor');
themeToggleBtn = document.getElementById('themeToggle');
// –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
downloadCount = parseInt(localStorage.getItem('downloadCount') || '0');
totalChars = parseInt(localStorage.getItem('totalChars') || '0');
document.getElementById('statDownloads').textContent = downloadCount;
document.getElementById('statChars').textContent = totalChars;
// –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã
loadTheme();
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å –¥–µ–±–∞—É–Ω—Å–æ–º
editor.addEventListener('input', () => {
clearTimeout(previewTimeout);
previewTimeout = setTimeout(updatePreview, 300);
});
// –ü–µ—Ä–≤–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
updatePreview();
// –ó–∞–≥—Ä—É–∑–∫–∞ KaTeX
await loadKaTeX();
// –ó–∞–≥—Ä—É–∑–∫–∞ Graphviz (—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ª–æ–∫–∞–ª—å–Ω–æ!)
await loadGraphviz();
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
setupEventListeners();
// –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
setTimeout(() => {
showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Markdown2PDF Pro! –ù–∞–∂–º–∏—Ç–µ Ctrl+F –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É.', 'success', 6000);
}, 1000);
});
// ==================== –ó–ê–ì–†–£–ó–ö–ê –¢–ï–ú–´ ====================
function loadTheme() {
const savedTheme = localStorage.getItem('theme') || 'dark';
document.documentElement.setAttribute('data-theme', savedTheme);
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º—ã
const icon = themeToggleBtn.querySelector('i');
if (savedTheme === 'dark') {
icon.className = 'fas fa-moon';
icon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É';
} else {
icon.className = 'fas fa-sun';
icon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É';
}
}
// ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –¢–ï–ú–´ ====================
themeToggleBtn?.addEventListener('click', () => {
const currentTheme = document.documentElement.getAttribute('data-theme');
const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
document.documentElement.setAttribute('data-theme', newTheme);
localStorage.setItem('theme', newTheme);
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏
const icon = themeToggleBtn.querySelector('i');
if (newTheme === 'dark') {
icon.className = 'fas fa-moon';
icon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É';
showNotification('–¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞', 'success', 2000);
} else {
icon.className = 'fas fa-sun';
icon.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ç–µ–º–Ω—É—é —Ç–µ–º—É';
showNotification('–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞', 'success', 2000);
}
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç–∏–ª–µ–π
updatePreview();
});
// ==================== –ó–ê–ì–†–£–ó–ö–ê KATEX ====================
async function loadKaTeX() {
return new Promise((resolve, reject) => {
if (window.katex && window.renderMathInElement) {
resolve();
return;
}
const script = document.createElement('script');
script.src = 'https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js';
script.onload = () => {
const renderScript = document.createElement('script');
renderScript.src = 'https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js';
renderScript.onload = () => {
console.log('KaTeX —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
resolve();
};
renderScript.onerror = reject;
document.head.appendChild(renderScript);
};
script.onerror = reject;
document.head.appendChild(script);
});
}
// ==================== –ó–ê–ì–†–£–ó–ö–ê GRAPHVIZ ====================
async function loadGraphviz() {
try {
// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ª–∏ —É–∂–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
if (window.Graphviz) {
graphvizInstance = await window.Graphviz.load();
console.log('Graphviz —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ –∫—ç—à–∞');
updatePreview();
return graphvizInstance;
}
// –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É Graphviz
const script = document.createElement('script');
script.src = 'https://cdn.jsdelivr.net/npm/@hpcc-js/wasm@2.15.0/dist/graphviz.umd.min.js';
await new Promise((resolve, reject) => {
script.onload = resolve;
script.onerror = reject;
document.head.appendChild(script);
});
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä
if (window.Graphviz) {
graphvizInstance = await window.Graphviz.load();
console.log('Graphviz —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
// –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º
updatePreview();
}
return graphvizInstance;
} catch (error) {
console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Graphviz:', error);
showNotification('Graphviz –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –º–æ–≥—É—Ç –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è.', 'warning', 5000);
return null;
}
}
// ==================== –ù–ê–°–¢–†–û–ô–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–ë–´–¢–ò–ô ====================
function setupEventListeners() {
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
document.querySelectorAll('.tool-btn[data-format]').forEach(btn => {
btn.addEventListener('click', () => {
const format = btn.dataset.format;
applyFormat(format);
});
});
// –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
insertHeadingBtn.addEventListener('click', (e) => {
e.stopPropagation();
const rect = insertHeadingBtn.getBoundingClientRect();
headingMenu.style.left = `${rect.left}px`;
headingMenu.style.top = `${rect.bottom + 5}px`;
headingMenu.classList.toggle('active');
});
// –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
document.addEventListener('click', (e) => {
if (!insertHeadingBtn.contains(e.target) && !headingMenu.contains(e.target)) {
headingMenu.classList.remove('active');
}
});
// –¢–∞–±–ª–∏—á–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä
insertTableBtn.addEventListener('click', () => {
initTableEditor();
document.getElementById('tableModal').classList.add('active');
document.body.style.overflow = 'hidden';
});
// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
document.querySelectorAll('.close-modal, .modal-backdrop').forEach(el => {
el.addEventListener('click', (e) => {
if (e.target.classList.contains('modal-backdrop') || e.target.classList.contains('close-modal')) {
document.querySelectorAll('.modal-backdrop').forEach(m => m.classList.remove('active'));
document.body.style.overflow = '';
}
});
});
// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–µ–π
document.getElementById('addRowBtn').addEventListener('click', addTableRow);
document.getElementById('addColBtn').addEventListener('click', addTableColumn);
document.getElementById('removeRowBtn').addEventListener('click', removeTableRow);
document.getElementById('removeColBtn').addEventListener('click', removeTableColumn);
document.getElementById('insertTableConfirm').addEventListener('click', insertTable);
// –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
downloadBtn.addEventListener('click', downloadPDF);
// –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –æ—á–∏—Å—Ç–∫–æ–π –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
documentNameInput.addEventListener('input', () => {
// –û—á–∏—Å—Ç–∫–∞ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
let value = documentNameInput.value.trim();
value = value.replace(/[<>:"/\\|?*]/g, '_').replace(/\s+/g, '_');
// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã
if (value.length > 50) {
value = value.substring(0, 50);
}
// –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø—É—Å—Ç–∞—è, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
if (!value) value = 'document';
documentNameInput.value = value;
});
// –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞
fontSizeSelect.addEventListener('change', () => {
preview.style.fontSize = fontSizeSelect.value + 'px';
});
// –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –∏–∑ —à–∞–ø–∫–∏
document.querySelectorAll('[data-modal]').forEach(btn => {
btn.addEventListener('click', () => {
const modalId = btn.dataset.modal;
document.getElementById(modalId).classList.add('active');
document.body.style.overflow = 'hidden';
});
});
// –ü–æ–∏—Å–∫
toggleSearchBtn.addEventListener('click', toggleSearchPanel);
closeSearchBtn.addEventListener('click', closeSearchPanel);
searchNextBtn.addEventListener('click', findNext);
searchInput.addEventListener('input', performSearch);
searchInput.addEventListener('keydown', (e) => {
if (e.key === 'Enter') {
e.preventDefault();
findNext();
}
});
// –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞ Ctrl+F –¥–ª—è –ø–æ–∏—Å–∫–∞
document.addEventListener('keydown', (e) => {
if (e.ctrlKey && e.key === 'f') {
e.preventDefault();
toggleSearchPanel();
if (searchContainer.style.display !== 'none') {
searchInput.focus();
searchInput.select();
}
}
// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∏ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞ –ø–æ ESC
if (e.key === 'Escape') {
closeSearchPanel();
document.querySelectorAll('.modal-backdrop.active').forEach(modal => {
modal.classList.remove('active');
});
document.body.style.overflow = '';
headingMenu.classList.remove('active');
}
});
// –û—á–∏—Å—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
clearEditorBtn.addEventListener('click', () => {
if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
editor.value = `# –ù–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∑–¥–µ—Å—å...

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã
–ò–Ω–ª–∞–π–Ω —Ñ–æ—Ä–º—É–ª–∞: $E = mc^2$

–ë–ª–æ—á–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:
$$
\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}
$$

### DOT –¥–∏–∞–≥—Ä–∞–º–º–∞
\`\`\`dot
digraph G {
  rankdir=LR;
  node [shape=rectangle, style=filled];
  Start [label="–ù–∞—á–∞–ª–æ", fillcolor="#a3c1e1"];
  End [label="–ö–æ–Ω–µ—Ü", fillcolor="#f4a2a2"];
  Start -> End;
}
\`\`\`

### –¢–∞–±–ª–∏—Ü–∞
| –ó–∞–≥–æ–ª–æ–≤–æ–∫ 1 | –ó–∞–≥–æ–ª–æ–≤–æ–∫ 2 |
|-------------|-------------|
| –Ø—á–µ–π–∫–∞ 1    | –Ø—á–µ–π–∫–∞ 2    |
| –Ø—á–µ–π–∫–∞ 3    | –Ø—á–µ–π–∫–∞ 4    |

### –¶–∏—Ç–∞—Ç–∞
> –≠—Ç–æ –ø—Ä–∏–º–µ—Ä —Ü–∏—Ç–∞—Ç—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ.

---
–ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —Å–æ–∑–¥–∞–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤!`;
updatePreview();
showNotification('–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω', 'success');
}
});
// –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
editor.addEventListener('scroll', highlightCurrentLine);
editor.addEventListener('mousemove', highlightCurrentLine);
editor.addEventListener('focus', highlightCurrentLine);
editor.addEventListener('blur', () => {
editor.classList.remove('current-line');
});
// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
document.querySelectorAll('.view-toggle-btn').forEach(btn => {
btn.addEventListener('click', () => {
const view = btn.dataset.view;
// –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
document.querySelectorAll('.view-toggle-btn').forEach(b => b.classList.remove('active'));
btn.classList.add('active');
// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –ø–∞–Ω–µ–ª—å
document.querySelectorAll('.content-area').forEach(area => area.classList.remove('active'));
document.getElementById(`${view}View`).classList.add('active');
currentView = view;
// –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –Ω–µ–≥–æ
if (view === 'preview') {
updatePreview();
}
});
});
}
// ==================== –§–£–ù–ö–¶–ò–ò –†–ï–î–ê–ö–¢–û–†–ê ====================
function applyFormat(format) {
const startPos = editor.selectionStart;
const endPos = editor.selectionEnd;
const selectedText = editor.value.substring(startPos, endPos);
let newText = '';
switch(format) {
case 'bold':
newText = `**${selectedText || '–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç'}**`;
break;
case 'italic':
newText = `*${selectedText || '–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç'}*`;
break;
case 'link':
newText = `[${selectedText || '—Ç–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏'}](https://example.com)`;
break;
case 'list':
newText = selectedText
? selectedText.split('\n').map(line => `- ${line}`).join('\n')
: `- –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ 1\n- –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ 2`;
break;
case 'code':
newText = selectedText
? `\`\`\`\n${selectedText}\n\`\`\``
: `\`\`\`\n// –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\nconsole.log("–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!");\n\`\`\``;
break;
case 'quote':
newText = selectedText
? selectedText.split('\n').map(line => `> ${line}`).join('\n')
: `> –≠—Ç–æ —Ü–∏—Ç–∞—Ç–∞\n> –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Ü–∏—Ç–∞—Ç—ã`;
break;
case 'pageBreak':
newText = '\n---\n';
break;
}
editor.value = editor.value.substring(0, startPos) + newText + editor.value.substring(endPos);
editor.selectionStart = startPos;
editor.selectionEnd = startPos + newText.length;
editor.focus();
updatePreview();
}
function insertTextAtCursor(text, wrapBefore = '', wrapAfter = '') {
const startPos = editor.selectionStart;
const endPos = editor.selectionEnd;
const selectedText = editor.value.substring(startPos, endPos);
editor.value = editor.value.substring(0, startPos) +
wrapBefore + (selectedText || text) + wrapAfter +
editor.value.substring(endPos);
if (selectedText) {
editor.selectionStart = startPos;
editor.selectionEnd = endPos + wrapBefore.length + wrapAfter.length;
} else {
editor.selectionStart = editor.selectionEnd = startPos + wrapBefore.length + text.length;
}
editor.focus();
updatePreview();
}
// ==================== –ü–û–ò–°–ö ====================
function toggleSearchPanel() {
if (searchContainer.style.display === 'none' || searchContainer.style.display === '') {
searchContainer.style.display = 'block';
searchInput.focus();
searchInput.select();
performSearch();
} else {
closeSearchPanel();
}
}
function closeSearchPanel() {
searchContainer.style.display = 'none';
searchInput.value = '';
searchStatusEl.textContent = '0 –∏–∑ 0';
currentSearchIndex = -1;
searchResults = [];
editor.focus();
}
function performSearch() {
const searchTerm = searchInput.value.trim();
if (!searchTerm) {
searchStatusEl.textContent = '0 –∏–∑ 0';
currentSearchIndex = -1;
searchResults = [];
return;
}
const content = editor.value;
searchResults = [];
let index = content.indexOf(searchTerm, 0);
while (index !== -1) {
searchResults.push(index);
index = content.indexOf(searchTerm, index + 1);
}
currentSearchIndex = searchResults.length > 0 ? 0 : -1;
updateSearchStatus();
if (searchResults.length > 0) {
highlightSearchResult();
}
}
function findNext() {
if (searchResults.length === 0) {
performSearch();
return;
}
currentSearchIndex = (currentSearchIndex + 1) % searchResults.length;
updateSearchStatus();
highlightSearchResult();
}
function updateSearchStatus() {
if (searchResults.length === 0) {
searchStatusEl.textContent = '0 –∏–∑ 0';
} else {
searchStatusEl.textContent = `${currentSearchIndex + 1} –∏–∑ ${searchResults.length}`;
}
}
function highlightSearchResult() {
if (currentSearchIndex === -1 || searchResults.length === 0) return;
const pos = searchResults[currentSearchIndex];
const searchTerm = searchInput.value.trim();
editor.focus();
editor.setSelectionRange(pos, pos + searchTerm.length);
// –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ç–µ–∫—Å—Ç—É
const lines = editor.value.substring(0, pos).split('\n');
editor.scrollTop = (lines.length - 5) * 18; // –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫–∏
}
// ==================== –ü–û–î–°–í–ï–¢–ö–ê –¢–ï–ö–£–©–ï–ô –°–¢–†–û–ö–ò ====================
function highlightCurrentLine() {
// –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
if (document.activeElement === editor) {
editor.classList.add('current-line');
} else {
editor.classList.remove('current-line');
}
}
// ==================== –¢–ê–ë–õ–ò–ß–ù–´–ô –†–ï–î–ê–ö–¢–û–† ====================
let tableData = [
['', '', ''],
['', '', '']
];
function initTableEditor() {
tableData = [
['–ó–∞–≥–æ–ª–æ–≤–æ–∫ 1', '–ó–∞–≥–æ–ª–æ–≤–æ–∫ 2', '–ó–∞–≥–æ–ª–æ–≤–æ–∫ 3'],
['–Ø—á–µ–π–∫–∞ 1', '–Ø—á–µ–π–∫–∞ 2', '–Ø—á–µ–π–∫–∞ 3']
];
renderTableEditor();
}
function renderTableEditor() {
const tableGrid = document.getElementById('tableGrid');
tableGrid.innerHTML = '';
tableGrid.style.gridTemplateColumns = `repeat(${tableData[0].length}, 1fr)`;
tableData.forEach((row, i) => {
row.forEach((cell, j) => {
const input = document.createElement('input');
input.type = 'text';
input.className = 'table-cell';
input.value = cell;
input.dataset.row = i;
input.dataset.col = j;
input.placeholder = `–Ø—á–µ–π–∫–∞ ${i+1},${j+1}`;
input.addEventListener('input', (e) => {
tableData[i][j] = e.target.value;
});
tableGrid.appendChild(input);
});
});
}
function addTableRow() {
const newRow = Array(tableData[0].length).fill('');
tableData.push(newRow);
renderTableEditor();
}
function addTableColumn() {
tableData.forEach(row => row.push(''));
renderTableEditor();
}
function removeTableRow() {
if (tableData.length > 1) {
tableData.pop();
renderTableEditor();
} else {
showNotification('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–æ–∫—É', 'warning');
}
}
function removeTableColumn() {
if (tableData[0].length > 1) {
tableData.forEach(row => row.pop());
renderTableEditor();
} else {
showNotification('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü', 'warning');
}
}
function insertTable() {
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —à–∏—Ä–∏–Ω–µ)
const maxLengths = tableData[0].map((_, colIndex) =>
Math.max(...tableData.map(row => row[colIndex].length))
);
let md = '';
// –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
md += '| ' + tableData[0].map((cell, i) =>
cell.padEnd(maxLengths[i])
).join(' | ') + ' |\n';
// –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
md += '| ' + maxLengths.map(len => '-'.repeat(len)).join(' | ') + ' |\n';
// –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
for (let i = 1; i < tableData.length; i++) {
md += '| ' + tableData[i].map((cell, j) =>
cell.padEnd(maxLengths[j])
).join(' | ') + ' |\n';
}
// –í—Å—Ç–∞–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
const startPos = editor.selectionStart;
// –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø—É—Å—Ç–æ–π –∏–ª–∏ –∫—É—Ä—Å–æ—Ä –≤ –Ω–∞—á–∞–ª–µ, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –ª–∏—à–Ω–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏
const prefix = (editor.value.trim() === '' || startPos === 0) ? '' : '\n';
editor.value = editor.value.substring(0, startPos) + prefix + md + editor.value.substring(startPos);
editor.focus();
// –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
document.getElementById('tableModal').classList.remove('active');
document.body.style.overflow = '';
updatePreview();
showNotification('–¢–∞–±–ª–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∞', 'success');
}
// ==================== –ü–†–ï–î–ü–†–û–°–ú–û–¢–† ====================
function updatePreview() {
let text = editor.value;
try {
// –ü–∞—Ä—Å–∏–º Markdown
const html = marked.parse(text, {
breaks: true,
gfm: true,
mangle: false,
headerIds: false
});
// –û—á–∏—â–∞–µ–º HTML
const clean = DOMPurify.sanitize(html, {
USE_PROFILES: { html: true },
ADD_TAGS: ['svg', 'g', 'path', 'circle', 'rect', 'polygon', 'polyline', 'line', 'ellipse', 'text', 'image'],
ADD_ATTR: ['d', 'x', 'y', 'width', 'height', 'r', 'cx', 'cy', 'rx', 'ry', 'points', 'x1', 'y1', 'x2', 'y2', 'transform', 'fill', 'stroke', 'stroke-width', 'viewBox', 'xmlns', 'style', 'class', 'href', 'preserveAspectRatio']
});
preview.innerHTML = clean;
// –†–µ–Ω–¥–µ—Ä –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ KaTeX
if (window.renderMathInElement) {
renderMathInElement(preview, {
delimiters: [
{left: '$$', right: '$$', display: true},
{left: '\\[', right: '\\]', display: true},
{left: '$', right: '$', display: false},
{left: '\\(', right: '\\)', display: false}
],
throwOnError: false,
errorColor: '#cc0000',
strict: false
});
}
// –†–µ–Ω–¥–µ—Ä DOT –¥–∏–∞–≥—Ä–∞–º–º
renderDotDiagrams();
} catch (e) {
console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ Markdown:', e);
preview.innerHTML = `<p style="color: var(--error-color); padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border-left: 3px solid var(--error-color);">
<strong>–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ Markdown:</strong> ${e.message}
</p>`;
}
// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞
preview.style.fontSize = fontSizeSelect.value + 'px';
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
totalChars = text.length;
localStorage.setItem('totalChars', totalChars.toString());
document.getElementById('statChars').textContent = totalChars.toLocaleString('ru-RU');
}
// ==================== –†–ï–ù–î–ï–† DOT –î–ò–ê–ì–†–ê–ú–ú ====================
async function renderDotDiagrams() {
// –ñ–¥–µ–º, –ø–æ–∫–∞ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–Ω–¥–µ—Ä—ã –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è
await new Promise(resolve => setTimeout(resolve, 100));
const containers = preview.querySelectorAll('pre > code.language-dot, pre.language-dot > code, pre.language-dot');
for (const container of containers) {
// –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
const dotCode = container.textContent.trim();
if (!dotCode) continue;
// –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
const diagramContainer = document.createElement('div');
diagramContainer.className = 'dot-diagram-container';
diagramContainer.innerHTML = `<div class="dot-diagram-title">
<i class="fas fa-diagram-project"></i> Graphviz –¥–∏–∞–≥—Ä–∞–º–º–∞
</div>`;
// –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É
try {
if (graphvizInstance) {
const svg = await graphvizInstance.layout(dotCode, 'svg', 'dot');
diagramContainer.innerHTML = svg;
// –£–ª—É—á—à–∞–µ–º SVG –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
const svgEl = diagramContainer.querySelector('svg');
if (svgEl) {
svgEl.style.maxWidth = '100%';
svgEl.style.height = 'auto';
svgEl.style.display = 'block';
svgEl.style.margin = '0 auto';
// –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —É–∑–ª–æ–≤
svgEl.querySelectorAll('ellipse, polygon, rect').forEach(node => {
node.style.stroke = '#2c7be5';
node.style.strokeWidth = '1.5';
if (!node.style.fill || node.style.fill === 'white' || node.style.fill === '#ffffff') {
node.style.fill = '#e3f2fd';
}
});
}
} else {
throw new Error('Graphviz –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
}
} catch (error) {
console.warn('–û—à–∏–±–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ DOT –¥–∏–∞–≥—Ä–∞–º–º—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥:', error);
// –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–æ–¥ –¥–∏–∞–≥—Ä–∞–º–º—ã —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
diagramContainer.innerHTML = `
<div class="dot-diagram-placeholder">
<div class="dot-diagram-title">
<i class="fas fa-diagram-project"></i> Graphviz –¥–∏–∞–≥—Ä–∞–º–º–∞
</div>
<div class="dot-code">${escapeHtml(dotCode)}</div>
<div class="dot-note">
<strong>üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∏–∞–≥—Ä–∞–º–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. 
–ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ –∫–æ–¥–∞.
</div>
</div>
`;
}
// –ó–∞–º–µ–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å –∫–æ–¥–æ–º –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –¥–∏–∞–≥—Ä–∞–º–º–æ–π
if (container.parentElement.tagName === 'PRE') {
container.parentElement.replaceWith(diagramContainer);
} else {
container.replaceWith(diagramContainer);
}
}
}
function escapeHtml(unsafe) {
return unsafe
.replace(/&/g, "&amp;")
.replace(/</g, "&lt;")
.replace(/>/g, "&gt;")
.replace(/"/g, "&quot;")
.replace(/'/g, "&#039;");
}
// ==================== –≠–ö–°–ü–û–†–¢ –í PDF ====================
async function downloadPDF() {
// –û—á–∏—â–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º
let filename = documentNameInput.value.trim();
filename = filename.replace(/[<>:"/\\|?*]/g, '_').replace(/\s+/g, '_');
if (!filename) filename = 'document';
if (filename.length > 50) filename = filename.substring(0, 50);
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π –¥–æ–∫—É–º–µ–Ω—Ç
if (!editor.value.trim()) {
showNotification('–ù–µ–ª—å–∑—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É—Å—Ç–æ–π –¥–æ–∫—É–º–µ–Ω—Ç', 'error');
return;
}
pdfLoader.classList.add('active');
try {
// –°–æ–∑–¥–∞–µ–º –∫–ª–æ–Ω –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
const clone = preview.cloneNode(true);
clone.id = '';
clone.style.width = '595pt'; // –®–∏—Ä–∏–Ω–∞ A4 –≤ –ø—É–Ω–∫—Ç–∞—Ö
clone.style.padding = '40pt 30pt';
clone.style.margin = '0';
clone.style.boxSizing = 'border-box';
clone.style.fontSize = `${fontSizeSelect.value}px`;
clone.style.color = '#1a1f2b';
clone.style.background = 'white';
clone.style.boxShadow = 'none';
// –£–±–∏—Ä–∞–µ–º –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø–µ—á–∞—Ç–∏
const decorativeElements = clone.querySelectorAll('.dot-diagram-title, .dot-note, .status-dot, .footer-slogan');
decorativeElements.forEach(el => el.remove());
// –£–ª—É—á—à–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ PDF
const tables = clone.querySelectorAll('table');
tables.forEach(table => {
table.style.width = '100%';
table.style.borderCollapse = 'collapse';
table.querySelectorAll('th, td').forEach(cell => {
cell.style.border = '1px solid #ddd';
cell.style.padding = '8px';
});
});
// –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
const tempContainer = document.createElement('div');
tempContainer.style.position = 'absolute';
tempContainer.style.left = '-9999px';
tempContainer.style.top = '0';
tempContainer.appendChild(clone);
document.body.appendChild(tempContainer);
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
const options = {
margin: [25, 20, 25, 20],
filename: `${filename}.pdf`,
html2canvas: {
scale: 2,
useCORS: true,
logging: false,
backgroundColor: '#ffffff',
allowTaint: true,
onclone: function(clonedDoc) {
// –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
const elements = clonedDoc.querySelectorAll('.dot-diagram-container, .katex-display, img, pre, table, blockquote');
elements.forEach(el => {
el.style.pageBreakInside = 'avoid';
el.style.breakInside = 'avoid';
});
}
},
jsPDF: {
unit: 'pt',
format: 'a4',
orientation: 'portrait'
},
pagebreak: {
mode: ['avoid-all', 'css', 'legacy'],
avoid: ['img', 'svg', '.katex-display', '.dot-diagram-container', 'pre', 'table', 'blockquote']
}
};
// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ PDF
await html2pdf().set(options).from(clone).save();
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
downloadCount++;
localStorage.setItem('downloadCount', downloadCount.toString());
document.getElementById('statDownloads').textContent = downloadCount.toLocaleString('ru-RU');
showNotification(`–î–æ–∫—É–º–µ–Ω—Ç "${filename}.pdf" —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`, 'success');
} catch (error) {
console.error('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ PDF:', error);
showNotification(`–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
} finally {
// –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
const tempContainers = document.querySelectorAll('div[style*="position: absolute"][style*="left: -9999px"]');
tempContainers.forEach(container => {
if (container.parentNode === document.body) {
document.body.removeChild(container);
}
});
pdfLoader.classList.remove('active');
}
}
// ==================== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ====================
function showNotification(message, type = 'success', duration = 5000) {
const notificationText = document.getElementById('notificationText');
const icon = notification.querySelector('i');
const progressBar = notification.querySelector('.notification-progress');
notificationText.textContent = message;
notification.className = '';
switch(type) {
case 'success':
notification.classList.add('show');
notification.classList.add('success');
icon.className = 'fas fa-check-circle success';
break;
case 'error':
notification.classList.add('show');
notification.classList.add('error');
icon.className = 'fas fa-exclamation-circle error';
break;
case 'warning':
notification.classList.add('show');
notification.classList.add('warning');
icon.className = 'fas fa-exclamation-triangle warning';
break;
}
// –°–±—Ä–æ—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
if (progressBar) {
progressBar.style.animation = 'none';
setTimeout(() => {
progressBar.style.animation = 'progress 5s linear forwards';
}, 10);
}
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
if (duration > 0) {
setTimeout(() => {
notification.classList.remove('show');
}, duration);
}
}
function closeNotification() {
notification.classList.remove('show');
}
// ==================== –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö ====================
window.addEventListener('error', (e) => {
console.error('–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞:', e.error);
if (e.error && e.error.message && !e.error.message.includes('ResizeObserver')) {
showNotification(`–û—à–∏–±–∫–∞: ${e.error.message}`, 'error');
}
});
window.addEventListener('unhandledrejection', (e) => {
console.error('–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –ø—Ä–æ–º–∏—Å-–∏—Å–∫–ª—é—á–µ–Ω–∏–µ:', e.reason);
if (e.reason && e.reason.message) {
showNotification(`–û—à–∏–±–∫–∞: ${e.reason.message}`, 'error');
}
});
</script>
</body>
</html>
